context("test-get_datacols")

test_that("Right length and content for get_data_cols", {
  dataset_name <- "yle_2011"
  data <- get_dataset(dataset_name)
  q_col=get_data_cols(dataset_name, data)
  party_col <- get_functional_column_name(data,alternative_spellings = c("puolue","Puolue","party"))
  data <- prepare_data(data, q_col, party_col)
  s <-  "1._Suomen_kuuluu_jatkossakin_tukea_taloudellisesti_ahdinkoon_joutuneita_EU-maita., 2._Suomessa_on_korruptiota,_joka_vaikuttaa_poliittisiin_päätöksiin., 3._Kouluissa_ja_oppilaitoksissa_on_otettava_käyttöön_viikoittainen_kasvisruokapäivä., 4._Rekisteröityneille_homopareille_pitää_kuulua_kaikki_samat_oikeudet_kuin_avioliiton_solmineille_heteropareille., 5._Maahanmuuttajien_vastaanottamista_ja_tukemista_verovaroin_on_tiukennettava., 6._Nato-jäsenyys_vahvistaisi_Suomen_turvallisuuspoliittista_asemaa., 7._Suomen_sotilaallinen_läsnäolo_Afganistanissa_on_ollut_virhe., 8._Presidentin_pitää_tulevaisuudessakin_johtaa_Suomen_ulko-_ja_turvallisuuspolitiikkaa_yhteistoiminnassa_hallituksen_kanssa., 9._Yksilön_vastuuta_omasta_ja_perheensä_hyvinvoinnista_on_lisättävä., 10._Ruotsin_kielen_opiskelun_pitää_olla_kouluissa_pakollista., 11._Yritysten_hallituksiin_on_säädettävä_lailla_sukupuolikiintiöt., 12._Asuntolainojen_korkovähennykset_on_poistettava_asteittain., 13._On_pikaisesti_säädettävä_vanhustenhoitolaki_joka_määrittelee_laadukkaan_hoidon_kriteerit_ja_sanktiot_niiden_laiminlyömisestä., 14._Kunnalliset_peruspalvelut_on_tuotettava_ensisijaisesti_kuntien_omalla_henkilöstöllä., 15._Lasten_päivähoito-oikeutta_tulee_voida_rajoittaa_perheissä,_joissa_ainakin_toinen_vanhemmista_on_kotona., 16._Maatalouden_tukia_on_ohjattava_siten,_että_vuonna_2030_ainakin_puolet_suomalaisesta_ruokatuotannosta_on_luomua., 17._Yritystukien_ehdoksi_on_asetettava_suomalaisten_työllistäminen., 18._Armeijan_uudistaminen_ei_ole_mahdollista_ilman_varuskuntien_määrän_karsimista., 19._Lakko-oikeutta_ei_ole_tarvetta_rajoittaa_millään_tavalla., 20._Seuraavan_eduskunnan_ei_tule_nostaa_eläkeikää., 21._Turpeen_energiakäyttöä_on_vähennettävä_ilmaston_lämpenemisen_hillitsemiseksi., 22._Työttömiä_on_kannustettava_töihin_porrastamalla_työttömyysturvaa_nykyistä_voimakkaammin., 23._Yritysten_voitoista_maksamaa_veroa_pitää_laskea., 24._Työttömyyden_lievittämiseksi_viikoittainen_työaika_on_lyhennettävä_35_tuntiin., 25._Eläkemaksuja_voidaan_korottaa_tuntuvasti,_jotta_nykyiset_eläke-edut_turvataan., 26._Seuraavalla_vaalikaudella_on_kiristettävä_suurituloisten_verotusta., 27._Valtion_on_taloutensa_tasapainottamiseksi_leikattava_menoja., 28._Taiteilijoita_on_koulutettava_Suomeen_nykyistä_vähemmän., 29._Korkeakouluopiskelijoiden_pitäisi_rahoittaa_opintojaan_nykyistä_enemmän_lainarahalla., 30._Tulevalla_vaalikaudella_tulee_myöntää_lupa_ainakin_yhden_uuden_ydinvoimalan_rakentamiselle., 31._Helsingissä_on_otettava_käyttöön_ruuhkamaksut_yksityisautoille., 32._Helsingin,_Espoon,_Kauniaisen_ja_Vantaan_on_yhdistyttävä, 33._Helsingissä_maahanmuuttajalapset_on_sijoitettava_tasaisesti_eri_kouluihin., 34._Mielestäni_seuraavassa_hallituksessa_on_oltava_mukana:, 35._Suosikkini_tulevan_hallituksen_pääministeriksi_on_(vain_yksi):"
  expect_equal(paste0(q_col, collapse=", "), s)
  expect_equal(length(q_col), 35)
})
